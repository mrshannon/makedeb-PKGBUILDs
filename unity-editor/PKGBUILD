# Maintainer: Michael R. Shannon <mrshannon.aerospace@gmail.com>
# Contributor: Oscar Morante <spacepluk at gmail dot com>

# Unity for Linux release thread:
# https://forum.unity.com/threads/unity-on-linux-release-notes-and-known-issues.350256/

_version=2018.2.7
_build=f1
_randomstring=4ebd28dd9664
_prefix=/opt/unity

# https://beta.unity3d.com/download/fe703c5165de/UnitySetup-2018.2.4f1
pkgname=unity-editor
pkgver=${_version}${_build}
pkgrel=1
section='devel'
pkgdesc="Unity3D game engine and editor."
read -r -d '' pkglong <<"EOF"
The world's most popular development platform for creating 2D and 3D
multiplatform games and interactive experiences.
EOF
arch=('x86_64')
url='https://unity3d.com/'
license=('custom')
makedepends=('libcanberra-gtk-module')
depends=('libc6'
         'libfreeimage3'
         'libgcc1'
         'libgdk-pixbuf2.0-0'
         'libgl1'
         'libglib2.0-0'
         'libglu1-mesa | libglu1'
         'libgtk-3-0'
         'libstdc++6'
         'libx11-6'
         'libxcursor1'
         'libxrandr2')
optdepends=('unity-editor-doc'
            'unity-editor-android'
            'unity-editor-ios'
            'unity-editor-mac'
            'unity-editor-webgl'
            'unity-editor-windows'
            'unity-editor-facebook')
source=("https://download.unity3d.com/download_unity/${_randomstring}/LinuxEditorInstaller/Unity.tar.xz"
        'unity-editor.desktop'
        'unity-editor.png')
sha1sums=('4b7e07b42e7d1731692d1103b9e19cf346289626'
          '789e51bca2b2be44590b5c35b8e261f7e4c4c749'
          'fddf4861974f88f0565de7f54f7418204e729894')

package() {
    # install Unity editor
    install -dm755 "${pkgdir}/${_prefix}/Editor"
    tar -C "${srcdir}/Editor" -cf - \
        . | tar -C "${pkgdir}/${_prefix}/Editor" -xf -

    # install .desktop file
    install -Dm644 "${srcdir}/${pkgname}.desktop" \
        "${pkgdir}/usr/share/applications/${pkgname}.desktop"

    # install binary
    install -dm755 "${pkgdir}/usr/bin"
    ln -s "${pkgdir}/opt/unity/Editor/Unity" "${pkgdir}/usr/bin/${pkgname}"
}
